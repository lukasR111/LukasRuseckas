--library
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

--Create window
local Window = Fluent:CreateWindow({
    Title = "Fluent " .. Fluent.Version,
    SubTitle = "by dawid",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

--tabs
local Tabs = {
    AutoFarm = Window:AddTab({ Title = "AutoFarm", Icon = "settings" }),
    ESP = Window:AddTab({ Title = "ESP", Icon = "users" }),
    Player = Window:AddTab({ Title = "Player", Icon = "person-standing" }),
    Killaura = Window:AddTab({ Title = "Kill Aura", Icon = "swords" }),
    Teleport = Window:AddTab({ Title = "Teleport", Icon = "locate-fixed" })
}

--Toggle 1: Auto Train
local Toggle = Tabs.AutoFarm:AddToggle("MyToggle", {
    Title = "Fist Strength", 
    Default = false 
})

Toggle:OnChanged(function(value)
    _G.AutoFarmEnabled = value
    
    if value then
        spawn(function()
            while _G.AutoFarmEnabled do
                wait(0.1)
                pcall(function()
                    game:GetService("ReplicatedStorage").RemoteEvents.FS_Train:FireServer()
                end)
            end
        end)
    end
end)

--Toggle 2: Body Toughness
local ToggleBT = Tabs.AutoFarm:AddToggle("BodyToughnessToggle", {
    Title = "Body Toughness", 
    Default = false 
})

ToggleBT:OnChanged(function(value)
    _G.BodyToughnessEnabled = value
    
    if value then
        spawn(function()
            while _G.BodyToughnessEnabled do
                wait(0.1)
                pcall(function()
                    game:GetService("ReplicatedStorage").RemoteEvents.BT_Train:FireServer()
                end)
            end
        end)
    end
end)

--Toggle 3: Psychic Power
local TogglePP = Tabs.AutoFarm:AddToggle("PsychicPowerToggle", {
    Title = "Psychic Power", 
    Default = false 
})

TogglePP:OnChanged(function(value)
    _G.PsychicPowerEnabled = value
    
    if value then
        spawn(function()
            while _G.PsychicPowerEnabled do
                local player = game.Players.LocalPlayer
                local character = player.Character
                
                local hasPsychicPower = false
                if character then
                    pcall(function()
                        local tool = character:FindFirstChild("Psychic Power") or player.Backpack:FindFirstChild("Psychic Power")
                        if character:FindFirstChildOfClass("Tool") or character:FindFirstChild("Psychic Power") then
                            hasPsychicPower = true
                        end
                    end)
                end
                
                if not hasPsychicPower and _G.PsychicPowerEnabled then
                    local VirtualInputManager = game:GetService("VirtualInputManager")
                    pcall(function()
                        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Three, false, game)
                        wait(0.05)
                        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Three, false, game)
                    end)
                end
                
                wait(2)
            end
        end)
    end
end)

--Toggle 4: Movement Speed BETA
local savedPosition = nil

local ToggleSpeed = Tabs.AutoFarm:AddToggle("MovementSpeedToggle", {
    Title = "Movement Speed BETA", 
    Default = false 
})

ToggleSpeed:OnChanged(function(value)
    _G.MovementSpeedEnabled = value
    
    if value then
        spawn(function()
            local VirtualInputManager = game:GetService("VirtualInputManager")
            local player = game.Players.LocalPlayer
            
            while _G.MovementSpeedEnabled do
                local character = player.Character
                
                if character and character:FindFirstChild("HumanoidRootPart") then
                    pcall(function()
                        local rootPart = character.HumanoidRootPart
                        
                        savedPosition = rootPart.CFrame
                        
                        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.W, false, game)
                        wait(0.05)
                        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.W, false, game)
                        
                        wait(0.02)
                        
                        if _G.MovementSpeedEnabled and savedPosition then
                            rootPart.CFrame = savedPosition
                        end
                    end)
                else
                    wait(0.05)
                end
            end
        end)
    end
end)

--Toggle 5: Jump Force
local ToggleJump = Tabs.AutoFarm:AddToggle("JumpForceToggle", {
    Title = "Jump Force", 
    Default = false 
})

ToggleJump:OnChanged(function(value)
    _G.JumpForceEnabled = value
    
    if value then
        spawn(function()
            local VirtualInputManager = game:GetService("VirtualInputManager")
            
            while _G.JumpForceEnabled do
                pcall(function()
                    VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Space, false, game)
                    wait(0.01)
                    VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Space, false, game)
                    wait(0.01)
                end)
            end
        end)
    end
end)

-- ==================== NAUJA ESP SISTEMA ====================
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local cfg = {
    enabled = false,
    showNames = true,
    visibleColor = Color3.fromRGB(0, 255, 0),
    hiddenColor = Color3.fromRGB(255, 0, 0),
    fillTrans = 0.7,
    outlineTrans = 0,
    minTextSize = 14,
    maxTextSize = 24,
    maxDist = 500,
    minDist = 10
}

local function checkVisibility(char)
    if not char then return false end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return false end
    
    local myChar = LocalPlayer.Character
    if not myChar then return false end
    local myHRP = myChar:FindFirstChild("HumanoidRootPart")
    if not myHRP then return false end
    
    local origin = myHRP.Position
    local direction = (hrp.Position - origin).Unit * (hrp.Position - origin).Magnitude
    
    local params = RaycastParams.new()
    params.FilterDescendantsInstances = {myChar, char}
    params.FilterType = Enum.RaycastFilterType.Exclude
    params.IgnoreWater = true
    
    return workspace:Raycast(origin, direction, params) == nil
end

local function addHighlight(char)
    if char:FindFirstChild("_HL") then return char._HL end
    
    local hl = Instance.new("Highlight")
    hl.Name = "_HL"
    hl.Adornee = char
    hl.FillTransparency = cfg.fillTrans
    hl.OutlineTransparency = cfg.outlineTrans
    hl.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    hl.Parent = char
    return hl
end

local function addNameTag(char, name)
    if char:FindFirstChild("_NT") then return char._NT end
    
    local head = char:FindFirstChild("Head")
    if not head then return nil end
    
    local bg = Instance.new("BillboardGui")
    bg.Name = "_NT"
    bg.Adornee = head
    bg.Size = UDim2.new(0, 200, 0, 50)
    bg.StudsOffset = Vector3.new(0, 2, 0)
    bg.AlwaysOnTop = true
    bg.Parent = char
    
    local txt = Instance.new("TextLabel")
    txt.Size = UDim2.new(1, 0, 1, 0)
    txt.BackgroundTransparency = 1
    txt.Text = name
    txt.TextColor3 = Color3.fromRGB(255, 255, 255)
    txt.TextStrokeTransparency = 0.5
    txt.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    txt.Font = Enum.Font.GothamBold
    txt.TextSize = cfg.maxTextSize
    txt.Parent = bg
    
    return bg
end

local function updateESP(char)
    local hl = char:FindFirstChild("_HL")
    if not hl then return end
    
    if checkVisibility(char) then
        hl.FillColor = cfg.visibleColor
        hl.OutlineColor = cfg.visibleColor
    else
        hl.FillColor = cfg.hiddenColor
        hl.OutlineColor = cfg.hiddenColor
    end
    
    if cfg.showNames then
        local nt = char:FindFirstChild("_NT")
        if nt and nt:FindFirstChild("TextLabel") then
            local hrp = char:FindFirstChild("HumanoidRootPart")
            local myHRP = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            
            if hrp and myHRP then
                local dist = (hrp.Position - myHRP.Position).Magnitude
                local clampedDist = math.clamp(dist, cfg.minDist, cfg.maxDist)
                local ratio = (clampedDist - cfg.minDist) / (cfg.maxDist - cfg.minDist)
                local size = cfg.maxTextSize - (ratio * (cfg.maxTextSize - cfg.minTextSize))
                nt.TextLabel.TextSize = math.clamp(size, cfg.minTextSize, cfg.maxTextSize)
            end
        end
    end
end

local function removeESP(char)
    local hl = char:FindFirstChild("_HL")
    if hl then hl:Destroy() end
    local nt = char:FindFirstChild("_NT")
    if nt then nt:Destroy() end
end

local function setupESP(char)
    if not cfg.enabled then return end
    task.wait(0.1)
    
    local plr = Players:GetPlayerFromCharacter(char)
    if plr and plr ~= LocalPlayer then
        addHighlight(char)
        if cfg.showNames then
            addNameTag(char, plr.Name)
        end
    end
end

for _, plr in pairs(Players:GetPlayers()) do
    if plr ~= LocalPlayer and plr.Character then
        setupESP(plr.Character)
    end
    plr.CharacterAdded:Connect(setupESP)
end

Players.PlayerAdded:Connect(function(plr)
    plr.CharacterAdded:Connect(setupESP)
end)

Players.PlayerRemoving:Connect(function(plr)
    if plr.Character then
        removeESP(plr.Character)
    end
end)

RunService.RenderStepped:Connect(function()
    if not cfg.enabled then return end
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer and plr.Character then
            updateESP(plr.Character)
        end
    end
end)

-- ESP Toggle GUI
local ToggleESP = Tabs.ESP:AddToggle("ESPToggle", {
    Title = "Chams", 
    Default = false 
})

ToggleESP:OnChanged(function(value)
    cfg.enabled = value
    
    if value then
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer and plr.Character then
                addHighlight(plr.Character)
                if cfg.showNames then
                    addNameTag(plr.Character, plr.Name)
                end
            end
        end
    else
        for _, plr in pairs(Players:GetPlayers()) do
            if plr.Character then
                removeESP(plr.Character)
            end
        end
    end
end)

-- Show Names Toggle
local ToggleNames = Tabs.ESP:AddToggle("NamesToggle", {
    Title = "Show Names", 
    Default = true 
})

ToggleNames:OnChanged(function(value)
    cfg.showNames = value
    
    if value then
        for _, plr in pairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer and plr.Character and cfg.enabled then
                addNameTag(plr.Character, plr.Name)
            end
        end
    else
        for _, plr in pairs(Players:GetPlayers()) do
            if plr.Character then
                local nt = plr.Character:FindFirstChild("_NT")
                if nt then nt:Destroy() end
            end
        end
    end
end)

-- ==================== PLAYER TELEPORT ====================
local selectedPlayer = nil

local function getPlayerNames()
    local names = {}
    for _, player in pairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer then
            table.insert(names, player.Name)
        end
    end
    return names
end

local PlayerDropdown = Tabs.ESP:AddDropdown("PlayerDropdown", {
    Title = "Select Player",
    Values = getPlayerNames(),
    Multi = false,
    Default = 1,
})

PlayerDropdown:OnChanged(function(Value)
    selectedPlayer = Value
end)

game.Players.PlayerAdded:Connect(function()
    wait(0.5)
    PlayerDropdown:SetValues(getPlayerNames())
end)

game.Players.PlayerRemoving:Connect(function()
    wait(0.5)
    PlayerDropdown:SetValues(getPlayerNames())
end)

Tabs.ESP:AddButton({
    Title = "Teleport to Player",
    Description = "Teleport to selected player",
    Callback = function()
        if selectedPlayer then
            local targetPlayer = game.Players:FindFirstChild(selectedPlayer)
            if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local localPlayer = game.Players.LocalPlayer
                if localPlayer.Character and localPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    localPlayer.Character.HumanoidRootPart.CFrame = targetPlayer.Character.HumanoidRootPart.CFrame
                end
            end
        end
    end
})

-- Player Speed Control
_G.PlayerSpeed = 16
_G.StatsEnabled = true

-- Auto Respawn Fast (Complete Mechanic)
local deathLocation = nil
local respawnCoordinates = {x = 968, y = 685}

local ToggleAutoRespawn = Tabs.Player:AddToggle("AutoRespawnToggle", {
    Title = "Auto Respawn", 
    Default = false 
})

ToggleAutoRespawn:OnChanged(function(value)
    _G.AutoRespawnEnabled = value
    
    if value then
        local player = game.Players.LocalPlayer
        
        local function setupDeath(character)
            local humanoid = character:WaitForChild("Humanoid", 5)
            local humanoidRootPart = character:WaitForChild("HumanoidRootPart", 5)
            
            if not humanoid or not humanoidRootPart then return end
            
            humanoid.Died:Connect(function()
                if not _G.AutoRespawnEnabled then return end
                
                deathLocation = humanoidRootPart.CFrame
                
                wait(5)
                
                if _G.AutoRespawnEnabled then
                    local VirtualInputManager = game:GetService("VirtualInputManager")
                    pcall(function()
                        VirtualInputManager:SendMouseButtonEvent(respawnCoordinates.x, respawnCoordinates.y, 0, true, game, 0)
                        wait(0.1)
                        VirtualInputManager:SendMouseButtonEvent(respawnCoordinates.x, respawnCoordinates.y, 0, false, game, 0)
                    end)
                    
                    wait(2)
                    
                    if _G.AutoRespawnEnabled and deathLocation then
                        pcall(function()
                            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                                player.Character.HumanoidRootPart.CFrame = deathLocation
                                
                                if _G.AutoInvisibleEnabled then
                                    wait(0.2)
                                    local VirtualInputManager = game:GetService("VirtualInputManager")
                                    VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.T, false, game)
                                    wait(0.05)
                                    VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.T, false, game)
                                end
                            end
                        end)
                    end
                end
            end)
        end
        
        if player.Character then
            setupDeath(player.Character)
        end
        
        player.CharacterAdded:Connect(function(character)
            if _G.AutoRespawnEnabled then
                wait(0.5)
                setupDeath(character)
            end
        end)
    end
end)

local AutoInvisibleToggle = Tabs.Player:AddToggle("AutoInvisibleToggle", {
    Title = "Auto Invisible ( Work only with auto respawn )",
    Default = false
})

AutoInvisibleToggle:OnChanged(function(value)
    _G.AutoInvisibleEnabled = value
end)

local SpeedSlider = Tabs.Player:AddSlider("SpeedSlider", {
    Title = "Speed",
    Min = 0,
    Max = 200,
    Default = 16,
    Rounding = 1,
    Callback = function(Value)
        _G.PlayerSpeed = Value
    end
})

_G.PlayerJump = 50

local JumpSlider = Tabs.Player:AddSlider("JumpSlider", {
    Title = "Jump Power",
    Min = 0,
    Max = 200,
    Default = 50,
    Rounding = 1,
    Callback = function(Value)
        _G.PlayerJump = Value
    end
})

local StatsToggle = Tabs.Player:AddToggle("StatsToggle", {
    Title = "Enable Stats", 
    Default = true 
})

StatsToggle:OnChanged(function(value)
    _G.StatsEnabled = value
end)

spawn(function()
    while true do
        if _G.StatsEnabled then
            pcall(function()
                local player = game.Players.LocalPlayer
                if player.Character and player.Character:FindFirstChild("Humanoid") then
                    player.Character.Humanoid.WalkSpeed = _G.PlayerSpeed
                    player.Character.Humanoid.JumpPower = _G.PlayerJump
                end
            end)
        end
        wait(0.05)
    end
end)

game.Players.LocalPlayer.CharacterAdded:Connect(function(character)
    local humanoid = character:WaitForChild("Humanoid", 5)
    if humanoid then
        humanoid.WalkSpeed = _G.PlayerSpeed
        humanoid.JumpPower = _G.PlayerJump
    end
end)

-- Killaura System
local selectedAttackMethod = "C"

local AttackDropdown = Tabs.Killaura:AddDropdown("AttackMethodDropdown", {
    Title = "Attack Method",
    Values = {"C (Punch)", "R (Balls)"},
    Multi = false,
    Default = 1,
})

AttackDropdown:OnChanged(function(Value)
    if Value == "C (Punch)" then
        selectedAttackMethod = "C"
    elseif Value == "R (Balls)" then
        selectedAttackMethod = "R"
    end
end)

local ToggleKillaura = Tabs.Killaura:AddToggle("KillauraToggle", {
    Title = "Kill Aura", 
    Default = false 
})

ToggleKillaura:OnChanged(function(value)
    _G.KillauraEnabled = value
    
    if value then
        spawn(function()
            local player = game.Players.LocalPlayer
            local VirtualInputManager = game:GetService("VirtualInputManager")
            
            while _G.KillauraEnabled do
                pcall(function()
                    local players = game.Players:GetPlayers()
                    local targetPlayers = {}
                    
                    for _, p in pairs(players) do
                        if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                            table.insert(targetPlayers, p)
                        end
                    end
                    
                    if #targetPlayers > 0 then
                        local randomPlayer = targetPlayers[math.random(1, #targetPlayers)]
                        
                        if randomPlayer and randomPlayer.Character and randomPlayer.Character:FindFirstChild("HumanoidRootPart") then
                            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                                player.Character.HumanoidRootPart.CFrame = randomPlayer.Character.HumanoidRootPart.CFrame
                            end
                            
                            wait(1)
                            
                            if _G.KillauraEnabled then
                                local keyCode = selectedAttackMethod == "C" and Enum.KeyCode.C or Enum.KeyCode.R
                                VirtualInputManager:SendKeyEvent(true, keyCode, false, game)
                                wait(0.05)
                                VirtualInputManager:SendKeyEvent(false, keyCode, false, game)
                            end
                            
                            wait(1)
                            
                            local players2 = game.Players:GetPlayers()
                            local targetPlayers2 = {}
                            
                            for _, p in pairs(players2) do
                                if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                                    table.insert(targetPlayers2, p)
                                end
                            end
                            
                            if #targetPlayers2 > 0 and _G.KillauraEnabled then
                                local randomPlayer2 = targetPlayers2[math.random(1, #targetPlayers2)]
                                if randomPlayer2 and randomPlayer2.Character and randomPlayer2.Character:FindFirstChild("HumanoidRootPart") then
                                    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                                        player.Character.HumanoidRootPart.CFrame = randomPlayer2.Character.HumanoidRootPart.CFrame
                                    end
                                end
                            end
                        end
                    else
                        wait(0.5)
                    end
                end)
            end
        end)
    end
end)

-- Teleport Tab - Dropdowns
local selectedFist = nil
local selectedBody = nil
local selectedPsychic = nil

local FistDropdown = Tabs.Teleport:AddDropdown("FistDropdown", {
    Title = "Fist",
    Values = {"None", "100 FS", "10K FS", "Location 3"},
    Multi = false,
    Default = 1,
})

FistDropdown:OnChanged(function(Value)
    selectedFist = Value
end)

local BodyDropdown = Tabs.Teleport:AddDropdown("BodyDropdown", {
    Title = "Body",
    Values = {"None", "100BT", "10K BT", "100K BT", "1M BT", "10M BT", "1B BT"},
    Multi = false,
    Default = 1,
})

BodyDropdown:OnChanged(function(Value)
    selectedBody = Value
end)

local PsychicDropdown = Tabs.Teleport:AddDropdown("PsychicDropdown", {
    Title = "Psychic",
    Values = {"None", "1M PP", "1B PP", "1T PP", "1Q PP"},
    Multi = false,
    Default = 1,
})

PsychicDropdown:OnChanged(function(Value)
    selectedPsychic = Value
end)

Tabs.Teleport:AddButton({
    Title = "Teleport",
    Description = "Teleport to selected location",
    Callback = function()
        local player = game.Players.LocalPlayer
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local targetCFrame = nil
            local selectedLocation = ""
            
            if selectedFist and selectedFist ~= "None" then
                if selectedFist == "100 FS" then
                    targetCFrame = CFrame.new(409.13, 271.25, 980.60)
                    selectedLocation = selectedFist
                elseif selectedFist == "10K FS" then
                    targetCFrame = CFrame.new(-2275.87, 1943.37, 1052.95)
                    selectedLocation = selectedFist
                end
            end
            
            if not targetCFrame and selectedBody and selectedBody ~= "None" then
                if selectedBody == "100BT" then
                    targetCFrame = CFrame.new(366.89, 249.73, -445.54)
                elseif selectedBody == "10K BT" then
                    targetCFrame = CFrame.new(357.52, 263.77, -493.06)
                elseif selectedBody == "100K BT" then
                    targetCFrame = CFrame.new(1638.67, 259.38, 2247.90)
                elseif selectedBody == "1M BT" then
                    targetCFrame = CFrame.new(-2302.58, 977.26, 1069.75)
                elseif selectedBody == "10M BT" then
                    targetCFrame = CFrame.new(-2041.47, 714.27, -1908.34)
                elseif selectedBody == "1B BT" then
                    targetCFrame = CFrame.new(-246.11, 286.70, 983.57)
                end
                selectedLocation = selectedBody
            end
            
            if not targetCFrame and selectedPsychic and selectedPsychic ~= "None" then
                if selectedPsychic == "1M PP" then
                    targetCFrame = CFrame.new(-2534.24, 5486.58, -534.81)
                elseif selectedPsychic == "1B PP" then
                    targetCFrame = CFrame.new(-2564.64, 5501.09, -440.80)
                elseif selectedPsychic == "1T PP" then
                    targetCFrame = CFrame.new(-2581.01, 5516.37, -502.65)
                elseif selectedPsychic == "1Q PP" then
                    targetCFrame = CFrame.new(-2543.56, 5409.46, -491.60)
                end
                selectedLocation = selectedPsychic
            end
            
            if targetCFrame then
                player.Character.HumanoidRootPart.CFrame = targetCFrame
            end
        end
    end
})
